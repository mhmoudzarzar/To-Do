<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>To-Do App</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        text-transform: capitalize;
      }
      body {
        font-family: Arial, sans-serif;
      }

      header {
        background-color: #4caf50;
        color: white;
        padding: 1rem;
        position: sticky;
        top: 0;
        z-index: 90;
        width: 100%;
        text-align: center;
      }
      main {
        width: 100%;
        margin-top: 2rem;
        display: flex;
        justify-content: space-evenly;
        flex-direction: row-reverse;
        align-items: flex-start;
      }
      button {
        border: none;
        background-color: #4caf50;
        color: white;
        cursor: pointer;
      }
      button:hover {
        background-color: #45a049;
      }
      ul {
        list-style-type: none;
        padding: 0;
      }

    
      .taskSection {
        width: 80%;
        background-color: teal;
        border-radius: 1rem;
        max-height: 80vh;
        min-height: 50vh;
        overflow-y: auto;
        padding-bottom: 1rem;
      }
      .inputSection {
        width: 100%;
        padding: 1rem;
        text-align: center;
        position: sticky;
        top: 0;
        background-color: teal;
        z-index: 1;
      }
      .inputContainer {
        display: flex;
        justify-content: center;
        gap: 1rem;
        margin: 1rem;
      }
      .inputSection label {
        color: white;
        font-weight: bold;
        align-self: center;
        font-size: 1.2rem;
        display: block;
      }
      .inputSection input {
        width: 70%;
        padding: 0.5rem;
        border: 1px solid #ccc;
        border-radius: 4px;
      }
      .inputSection button {
        padding: 0.5rem 1rem;
        border-radius: 4px;
      }
      #taskList {
        margin-top: 2rem;
        display: flex;
        flex-direction: column;
        align-items: center;
        width: 100%;
      }
      li {
        width: 90%;
        padding: 1rem;
        border-bottom: 1px solid #ccc;
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 1rem;
        background-color: #f9f9f9;
        margin-bottom: 0.5rem;
        border-radius: 0.5rem;
        flex-wrap: wrap;
      }
      .buttonDiv {
        display: flex;
        gap: 0.5rem;
      }
      .buttonDiv button {
        padding: 0.3rem 0.6rem;
        border-radius: 0.4rem;
        font-size: 0.9rem;
      }
      .dateSpan {
        font-size: 0.8rem;
        color: gray;
        margin-left: 1rem;
      }
      progress {
        width: 90%;
        margin: 1rem auto;
        display: block;
      }
      #progressLabel {
        text-align: center;
        color: white;
        font-weight: bold;
        margin-bottom: 0.5rem;
      }
    </style>
  </head>
  <body>
    <header><h1>To-Do</h1></header>
    <main>
      <section class="taskSection">
        <div class="inputSection">
          <label for="taskInput">New Task:</label>
          <div class="inputContainer">
            <input type="text" id="taskInput" placeholder="Enter a new task" />
            <button id="addTaskButton">Add Task</button>
          </div>
        </div>
        <div>
          <p id="progressLabel">0% Completed</p>
          <progress id="progressBar" value="0" max="100"></progress>
          <ul id="taskList"></ul>
        </div>
      </section>
      
    </main>
    <script>
      const taskInput = document.getElementById("taskInput");
      const addTaskButton = document.getElementById("addTaskButton");
      const taskList = document.getElementById("taskList");
      const progressBar = document.getElementById("progressBar");
      const progressLabel = document.getElementById("progressLabel");

      class Task {
        constructor(name, id = null) {
          this.name = name;
          this.id = id || Math.floor(Math.random() * 10000);
          this.dayCreated = new Date();
          this.completed = false;
        }

        createTask() {
          const taskItem = document.createElement("li");
          taskItem.id = this.id;

          const taskTextSpan = document.createElement("span");
          taskTextSpan.textContent = this.name;
          taskItem.appendChild(taskTextSpan);

          const dateSpan = document.createElement("span");
          dateSpan.className = "dateSpan";
          dateSpan.textContent = `Created on: ${this.dayCreated.toLocaleDateString()} ${this.dayCreated.toLocaleTimeString()}`;

          const completeButton = document.createElement("button");
          completeButton.textContent = "Complete";
          completeButton.addEventListener("click", () =>
            this.complete(taskItem)
          );

          const editButton = document.createElement("button");
          editButton.textContent = "Edit";
          editButton.addEventListener("click", () => this.edit(taskTextSpan));

          const deleteButton = document.createElement("button");
          deleteButton.textContent = "Delete";
          deleteButton.addEventListener("click", () => this.delete(taskItem));

          const undoButton = document.createElement("button");
          undoButton.textContent = "Undo";
          undoButton.addEventListener("click", () => this.undo(taskItem));

          const buttonDiv = document.createElement("div");
          buttonDiv.className = "buttonDiv";
          buttonDiv.appendChild(completeButton);
          buttonDiv.appendChild(undoButton);
          buttonDiv.appendChild(editButton);
          buttonDiv.appendChild(deleteButton);

          taskItem.appendChild(buttonDiv);
          taskItem.appendChild(dateSpan);
          taskList.appendChild(taskItem);

          updateProgress();
        }

        complete(taskItem) {
          if (!this.completed) {
            this.completed = true;
            taskItem.style.backgroundColor = "green";
            taskItem.style.color = "white";
            taskItem.style.fontStyle = "italic";
            updateProgress();
          }
        }

        undo(taskItem) {
          if (this.completed) {
            this.completed = false;
            taskItem.style.textDecoration = "none";
            taskItem.style.backgroundColor = "#f9f9f9";
            taskItem.style.color = "black";
            taskItem.style.fontStyle = "normal";
            updateProgress();
          }
        }

        delete(taskItem) {
          taskItem.remove();
          updateProgress();
        }

        edit(taskTextSpan) {
          const newName = prompt("Edit task name:", this.name);
          if (!newName || /^[0-9]+$/.test(newName)) {
            alert("Please enter a valid task.");
            return;
          }
          this.name = newName;
          taskTextSpan.textContent = newName;
        }
      }

      function updateProgress() {
        const tasks = document.querySelectorAll("#taskList li");
        const totalTasks = tasks.length;
        const completedTasks = Array.from(tasks).filter((li) =>
          li.style.backgroundColor.includes("green")
        ).length;

        const percent = totalTasks === 0 ? 0 : Math.round((completedTasks / totalTasks) *100);

        progressBar.value = percent;
        progressLabel.textContent = `${percent}% Completed`;
      }

      addTaskButton.addEventListener("click", () => {
        const taskText = taskInput.value.trim();
        if (!taskText || /^[0-9]+$/.test(taskText)) {
          alert("Please enter a valid task.");
          return;
        }

        const newTask = new Task(taskText);
        newTask.createTask();
        taskInput.value = "";
      });
    </script>
  </body>
</html>
